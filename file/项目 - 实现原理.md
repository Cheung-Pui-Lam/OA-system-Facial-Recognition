# 项目 - 实现原理

- **（基于人脸识别的企业自动化办公OA系统）**

- **[项目展示视频: YouTube](https://www.youtube.com/watch?v=vlpo4U4Lilc)**
- **[项目展示视频: BiliBili]()**

## 项目的功能模块实现原理:

### 1. 登录鉴权

- **这是一个公共功能(所有类型的员工都能使用),这个功能主要使用到了`jwt`,前端页面通过输入用户数据(账号密码)并选择登录的用户类型队后点击登录发送post网络请求将用户输入的数据放在响应体中向后端请求对应的用户数据,后端接收到前端发送过来的请求后将请求体中的数据解析出来并查找数据库,匹配到对应的用户数据则返回给前端页面,并且服务器将该用户数据使用`jwt`模块生成`token`一并返回给前端页面,前端页面接收到登陆成功的数据后,使用`axios响应拦截器`,将返回的`token`数据保存到浏览器的本地缓存中,用户数据则保存到`Vuex`中(`Vue`的集中式状态管理插件,用于方便组件间的数据通信),跳转到对应的用户等级(`普通员工`,`部门经理`,`公司老总`)页面,登陆成功后, 用户的每一个举动(页面的跳转,数据的请求都会通过`axios请求拦截器`带上浏览器的本地`token`,如果用户的`token`丢失或者过期(`默认为7天`)则强制跳转回登录界面需要重新登录获取`token`); 如果用户登录失败(填写的数据与数据库中的数据不匹配)则无法登陆成功! 我在这里做了一些数据的安全校验,前端通过登录接口携带到后端的`token`首先会通过后端中间件的校验,该中间件会通过我设置好的解析密钥解析当前的携带过来的`token`,如果解析成功才会真正的进入到该接口的设置中,同时生成一个新的`token`返回个前端页面,反之则会返回一个状态码500,前端的响应拦截器在接收到该状态码后会直接返回到登陆页面要求重新登陆获取最新的`token`并且会清除浏览器缓存中的`token`保存字段, 前端页面的路由设计同样存在中间件来校验登陆状态,那就是`Vue`中的路由守卫,我们在系统中的每一次页面跳转(路由跳转)都会经过这一个路由守卫,是否放行的判断条件就是浏览器本地缓存中的`token`字段,如果不存在`token`字段则直接返回登陆界面重新登陆生成新的`token`**

### 2. 密码修改

- **这是一个公共功能(所有类型员工都能使用), 密码的修改功能其实也是用了`操作数据库`的`查`和`改`功能,用户将旧的密码和新的密码填写过后点击修改按钮发送网络请求,将`Vuex`中的用户数据与数据库中的数据进行对比,匹配到对应的员工后,再将输入的旧密码与数据库中改员工的密码进行对比,匹配成功则将新的密码覆盖掉原来数据库中员工旧的密码,如果填写的旧密码与数据库中的密码不匹配则无法实现修改!**

### 3. 人脸识别(上班下班)

- **人脸识别这个功能实现则是使用`face-api.js`这个第三方，里面有选练好的模型，我们直接调用即可。`Face-api.js `是一个` JavaScript API`，是基于 `tensorflow.js` 核心 `API` 的人脸检测和人脸识别的浏览器实现。它实现了一系列的卷积神经网络（`CNN`），针对网络和移动设备进行了优化。这一模块的作用是用于员工的打卡上下班的，调用这个第三方库后，硬件摄像头采集到的图象数对比你登录过后，存在数据库中的用户图片数据(头像)根据该库中的算法生成一个数值(0-1),数值越小证明两个图像越相似，一般来讲，当该数值小于0.6就基本可以判定是同一个人了。(这里我设置的判定阈值是0.4),系统会根据用户当前的状态进行打卡判定,不能重复打卡。**

### 4. 请假模块

- **请假模块分为两个小模块,一个是请假功能,另一个是管理请假功能,请假功能是普通员工以及部门经理才具有的功能,普通员工在首页点击请假后会弹出一个表单,员工填写请假表单(假条)后经过表单验证(判断是否为对应的员工(输入员工id,员工姓名等...还有去其他必填项后)) 点击发送,就可以将该请假条发送给对应的上级去进行审批,发送假条的同时调用`Websocket`实时通知对应的上级(部门的普通员工就发送给对应的部门经理审批,部门经理则统一发送给董事审批), 我们还可以在`我的假条`这一栏中查看我们的请假记录,可以对该假条进行增删改查,但是只能删除非本月的请假数据(`假条`),因为本月的请假数据要结合员工的本月考勤数据的,因此我们只能删除非本月的请假条; 后面则是请假管理功能模块,该模块仅为部门经理和公司董事的专属功能模块, 下级(普通员工和部门经理)在向上级(部门经理和公司董事)发送请假请求过后, 上级就会通过即时通讯(`websocket`)接收到假条审批信息,随后在请假管理这一模块对该员工的请假申请进行审批, 审批(同意或拒绝)过后,请假结果同样会通过即时通讯(`websocket`)将请假的结果以及该假条信息发送回给对应的申请员工。**

### 5. 员工管理(员工数据的增删改查)

- **员工管理功能是后台管理员的专属功能，一般用于对该系统中的用户数据进行增删改查，用户数据是保存到数据库(`mysql`)中的前端页面以表单的形式手机数据再通过网络接口将数据携带到后端,后端根据接口中解析下来的数据在操作数据库,实现增删该查操作**
- **值得一提的是,员工的数据查看功能同样是部门经理和公司董事的功能,部门经理可以查看并搜索自己管辖的部门下的多有普通员工的数据,而公司董事则可以查看到这个公司所有员工的数据**

### 6. 文件上传以及下载(头像上传以及文件上传到数据库)

- **文件上传功能同样是一个公共功能,在这个系统中很多地方都会用到,比如用户头像的上传,公告文件的上传,任务流程文件的上传等等.. 具体实现是有两个方面的,一方面是头像的上传,因为头像数据一般来讲是图片数据,且要求头像数据在登陆过后的加载速度要快,并且我在前端页面限制了头像上传的文件类型以及大小限制, 由此来讲,该文件的数据不会过大,这里我就选择将该头像数据以`base64`的格式保存到服务器中去,用户在发送上传头像的请求接口过后,后端接收到前端传过来的图片数据就会将其包窜到服务器的指定文件夹中同时调用`express`框架的内置文件模块(`fs`)删除用户的旧的头像数据以此来减少服务器的负担,而类似公告文件以及任务流程文件等相较于图片来讲较大的数据则是以`blob`二进制数据流的格式保存到数据库中,两者的上传均是使用`multer`插件,但是与上传头像不同的是,文件上传到数据库使用的是磁盘存储模式(`图片上传到服务器使用的是内存存储模式`);该系统为用户提供三种存储文件的地方,一种是公仓,一种是部门仓,最后一种是用于保存公告文件或者是任务流程文件的,最后一种保存的文件在文件管理模块中是不存在这些数据的;用户在上传文件的时候可以选择文件的上传地方,上传至公仓则该系统下的所有员工均有权限下载获取,上传至部门仓则只有该部门下的员工用户有权限下载获取,并且非上传者无法对该文件进行删除操作,只有上传者才能对指定文件进行删除操作。前面提到文件的上传还细分两种,那就是公告文件以及任务流程文件,这两种文件是用于流转整个系统中的,前者是系统中董事级别用户进行公告的发布时可以携带文件一同发布,对应接收公告的员工可以获取该公告并进行该公告附件的下载操作;后者则是下级向上级提交流程审批时可以选择携带的附件(任务流程文件),上级接收到流程审批时可以对该附件进行下载操作。**

### 7. 部门管理(部门数据的增删改查)

- **部门管理就是简单的数据增删改查操作,实现对该公司下所有的部门进行增删改查,同时会影响对应的部门员工以及经理;实现原理基本与上面的员工数据的增删改查是基本一致的,不过不同的是员工表(`crew`)与部门表(`department`)是以`外键约束`的方式联合在一起,两张表的关联属性为:员工表(`crew`)的`department`字段和部门表(`department`)的`d_name`字段,也就是说在`公司董事`或系统管理员等级别的人物在删除现有的部门时,其部门中对应的员工的所在部门属性也就是`department`字段也会随之改变,这就是`外键约束`的`SET NULL`模式,当修改对应部门名称时则对应的部门下的员工也会随之改变**

### 8. 公告功能

- **公告功能在该系统中是董事级别用户特有的功能,作用是给对应的部门或全部部门发布公告通知,发布公告同时可以携带公告文件;实现原理如下: 董事级别用户在发布公告功能模块中填写公告内容以及是否携带文件,随后指定接收部门,点击提交按钮,系统会将填写的公告表单以及携带的文件通过post请求,以请求体携带参数的形式将数据发送到后端服务器上面(文件数据以multipart的形式传输到后端服务器上),后端服务器接收到数据,将表单数据存入数据库,将文件数据再次转换成二进制bolb形式存入到数据库中,同时将该文件数据的名称加上后缀([公告文件])用于区分其他文件,当然这个文件不会存放到公仓或者部门仓,要想下载该文件只能到对应的公告中下载; 公告发布完成后后台会根据表单中的数据进行判断该公告接收的部门,随后修改数据库中的用户数据,将对应部门下的员工中的`是否已读公告`字段更改为0,即未阅读公告,同时通过`websocket`给对应部门下的员工发送消息弹窗通知当前系统中对应部门下的在线用户当前有最新的发布公告,当未在线的用户再次登陆系统时,后端会根据数据库中该用户数据中的`是否已读公告`字段进行校验,如果为0,则使用消息弹窗提醒用户当前有最新的公告未读**

### 9. 聊天功能(IM模块)

- **聊天功能的实现是使用`websocket`技术(长连接网关)来实现的,什么是`websocket`技术呢?我们可以认为它是一种类似于`http`的协议,（`websocket`协议本质上是一个基于`tcp`的协议）,它实现了浏览器与服务器全双工通信，能更好的节省服务器资源和带宽并达到实时通讯的目的;要知道`http`协议的模式的运行流程是: `http协议`是单向通信的,即客户端先向服务器发送请求,服务器再给客户端响应数据, 服务器永远不可能低下头主动的给服务器响应数据的, 除非客户端先向服务器要数据, 也就是说,浏览器不主动请求的话,服务器是永远不可能给你发数据的,这就是`http`协议,那使用`http`协议来实现上面的应用场景的话其实也是可以实现的,不过实现起来比较麻烦, 常用的实现方法有`轮询`。所谓的`轮询`,其实就是在客户端(`js端`)设置一个定时器,按照一定的时间间隔向服务器发送请求, 来询问服务器是否有最新的数据(弹幕,聊天信息,位置等….),但是这种机制的确定就是实时性不够, 你想一想,如果客户端设置的时间过长,像如果1分钟发一次的话,那么你得到的最新消息就是1分钟以前的了, 如果你设置的过短的话, 频繁的请求服务器就会给服务器带来极大的压力,尤其是用户一多的话服务器的压力就更大了,随时可能宕机! 由此引出`websocket`技术,`webscoket`协议能够让服务器与客户端通过`握手(handshake)`来建立起全双工的通信方式,即任何一方都能够主动的发送消息给对方。`webscoket`并不是全新的协议，而是利用了`HTTP协议`来建立连接的,而`http协议`的底层其实是使用的`TCP协议`,我们都知道`TCP协议`是能够实现全双工通信的, 但是`http协议`为了精简,就在这个基础上阉割了`全双工通信`的功能,但是后来发现业务变复杂了,又需要`全双工通信`了,这时,`websocket`协议就应运而生了。**
- **项目当中的im模块就是使用socket技术来实现的,实现原理如下:我们这个系统是面向一般企业的,而一般的企业内部分三个阶层:最顶层的决策层也就是公司的董事,中间的管理层也就是部门经理以及下层的执行层也就是一般的部门员工,由此可见我作聊天群聊分配时就分配出三个群聊:公司总群(里面包含所有员工,不支持私聊,每个人都可以发送消息),部门群聊(里面包含对应部门下的所有员工,即所有的部门经理以及部门普工,支持私聊功能),最后就是高层群聊(里面包含公司董事以及所有的部门经理,同样支持私聊); 聊天功能的流程如下: 首先系统用户在前端页面登陆过后,点击聊天模块,选择对应的聊天群,此时发送消息时会携带消息数据,发送者,以及当前群的唯一字段(可以理解为群号)发送到后端服务器,后端服务器接收到这些数据后,会将数据转发给所有当前监听该群号的在线的用户,这就实现了简单的实时聊天功能,这里面有一个重点问题就是如何实现不同群之间的唯一字段分配呢?因为一个公司不可能只有一个部门,所以每一个部门群聊都应该是独立的,这里的解决方法就是,将该唯一字段绑定为该用户所在的部门名字即可,这样就实现了非同一部门群聊的冲突问题;下面再来说说私聊功能,私聊功能其实也是差不多相似的,只不过我们在发送消息时要写带上对方的唯一标识,可以是姓名也可以是id,这样后端接收到你发送过来的数据,就可以将该唯一标识在socket服务器中遍历,寻找到对应的用户,在作消息转发给对应的用户即可,这就实现了私聊功能;不仅如此我还新增了两个小功能,那就是消息免打扰功能以及浏览记录的保存,消息免打扰功能是使用结合Vue中的生命周期以及浏览器本地缓存(localstorage)来实现的,聊天记录也是保存到浏览器本地缓存当中去的,保存方式类似于淘宝等网站的一样,当我们进入网站时调用对应的生命周期函数,判断当前浏览器的本地缓存中是否存在聊天数据的保存字段,如果不存在就在浏览器本地缓存中新建一个字段用于保存聊天信息,随后我们登陆系统进行聊天,此时的聊天数据是保存到Vuex里面的(Vuex是Vue的一个周边生态,一个集中式的状态管理工具),当我们退出系统或关闭浏览器时,又会再次走向生命周期函数,将Vuex中的聊天数据保存到我们刚刚在浏览器本地缓存中新建的那个字段中去,当我们再次进入系统时,又会再次轴向生命周期函数,将我们上一次退出时保存到浏览器本地缓存中的聊天数据保存到Vuex中,这就实现了聊天数据的持久化了;下面再来讲讲消息免打扰功能的实现,类似于微信,我在聊天界面中同样设置了一个按钮用于点击关闭或打开消息免打扰功能,这一功能同样是结合Vue当中的生命周期函数和Vuex来实现的,我将判断是开启消息弹窗功能的标志位放在Vuex中,默认是开启的,当我们不在对应的聊天页面当中,当消息来的时候系统界面会跳一个弹窗提醒我们有最新的群聊或者私聊消息,当我们进入对应的聊天界面时,此时对应的聊天页面组件挂载,进入对应的生命周期,此时修改Vuex中的标志位,将其设置为关闭消息弹窗,当我们退出聊天页面时,组件中的生命周期函数再次响应,将Vuex中的标志为设置为开启,当然我们也可以在聊天界面中点击按钮手动修改Vuex中的弹框标志位,从而实现消息的免打扰功能。**

### 10. 业务流程功能

- **业务流程功能可谓是这个OA系统的特色功能了,这里的业务流程与请假功能模块非常的相似,但是相较于请假功能,业务流程功能更加的复杂繁琐;这里的业务流程功能同样是有两个功能模块的,一个是发布业务流程功能,另一个则是审批业务流程功能,发布业务流程功能是执行层的普通员工以及管理层的部门经理的共有功能,普通员工可以发布一个业务流程,选择审批的层级,一级业务流程是发送给对应的部门经理进行审批,发布二级业务流程则需要先给对应的部门经理审批,审批同意再走向下一级给决策层的公司董事进行审批,两者审批通过这个流程才算通过,反之任一环节审批不通过都算是不通过,当然业务流程的发布同样是可以携带文件的,下级再发布业务流程时,填写表单数据以及选择是否携带流程文件,点击确定过后,流程就会转送给对应的上级进行审批,(一级流程: 普通员工-->部门经理 , 部门经理 --> 公司董事 ; 二级流程: 普通员工 --> 部门经理 --> 公司董事);上级进行审批返回审批结果给对应的流程提交者,当然, 流程传递过程中的每一个环节都会有im模块的帮助,无论是提交审批请求还是返回审批结果都会有即时通讯的消息提醒,再系统中以消息弹窗的形式来提醒用户,弹窗提醒的方式以及流程与上面的请假请求一致。**

### 11. 考勤数据功能

- **考勤数据是使用第三方插件`Echarts`来实现数据可视化的,一共有三个数据,分别是:今日上班时间,本月上班时间以及本月请假次数,数据保存到数据中的; 这里我们来讲见实现原理,首先是今日上班时间,员工登陆系统过后打卡上班会调用`axios`发送一个`post`请求,请求参数会携带当时的时间戳,发送到后端保存到数据库中,当用户点击打卡下班的时候,会再次携带当时的时间戳到后端,(如果该用户忘记打卡下班,系统会在本日的23:59分自动执行打卡下班操作)随后前者减去后者再进行数据的转换就能获取到该用户今日的上班时间,随后将这个上班时间同步添加到该用户的本月上班时间当中去,当是时间来到本月的最后一天时,系统会自动调用接口将所有员工的本月上班时间清空; 本月请假次数就是获取用户的请假数据,将本月请假成功的数据提取出来转换成次数显示(上面的请假功模块中的删除假条功能只能删除非本月的假条,这样才能致使这些考勤数据更加的准确可靠)**

### 12. 考勤数据的输出

- **考勤数据的输出是公司董事的专有功能，实现原理是调用第三方的插件：`xlsx`,他能够实现将一段`json`数据转化为表格并保存到本地的操作,由此我们将后端请求回来的员工数据列表作一定的修改,保留一些标志性的属性如工号,姓名,所在部门,所在职位以及最重要的本月上班工时以及本月请假次数等...再将这段数据流经过这个第三方插件生成一个`excel`表格输出即可**



## 项目过程中遇到的问题(已解决)以及项目的新增功能

### 已解决

1. **新旧密码的更换【字符转数值】**
2. **更换头像【`multer`中间件的使用】**
3. **实时通讯(群聊和私聊)【`Vue-socket.io`的使用】**
4. **跨域问题产生token使得前端页面无法接收，但是后端已经返回**
5. **聊天记录的保存【`vuex`以及浏览器的本地缓存(`localstorage`)】**
6. **聊天记录的区分(我的和别人的)【`flex`布局的进阶使用】**
7. **聊天室聊天记录的向下滚动(异步处理)**
8. **人脸识别功能的实现【`face-api.js`的使用】**
9. **人脸识别功能的图片存在跨域问题**
10. **PC端跳转移动端的正则表达**
11. **最大的问题：首先设置`Vue实例`挂载后不立刻连接`socket`服务器,因为如果你当前的`token`过期亦或者当前你根本没有登录,那么此时浏览器的本地缓存中(`localStorage`)是不存在`tokne`字段的,此时如果连接`socket`服务器的话,那么带过去的`token`就是空值亦或者解析失败,因此我们就需要使用`Vue`中的`watch`属性来监听当前的用户登陆状态(`Vuex`中的`userInfo`中任意属性),登陆成功才开始连接`socket`服务器。此时还有一个问题,那就是：用户登陆成功后实现跳转，将`localStorage`中的`token`携带给`socket`服务器解析,但是如果用户是在`token`未过期的情况下使用`注销登录`按钮来返回登陆界面,那么这时的`localStorage`中的`token`已经被清除,但是项目的`Vue实例`已经挂载,也就是说此时你再登陆其他账号,通过`url`携带的`本地token`是`null`,也就是说此时连接到`socket`服务器后,是无法对你携带过去的`token`进行解析的,也就无法第一时间通过`socket`来发送消息,获取请假申请通知,获取请假返回通知以及用户的退出登录列表的实时刷线(`私聊对象列表`)。解决方法: 在`Login`页面,路由实现跳转后进行页面的`强制刷新`,这样就能保证每一次登录后都重新挂载一次`Vue实例`,`localStorage`中的`token`都是存在且是最新的!**

### 新增功能:

### 1. **请假功能**

- **功能需求:**
  - **请假功能存在职位区分,普工和部门经理请假需要提交请假条而老总则不需要(老总直接下班),普工的假条提交给对应所管辖下的部门经理审批,普工假条提交的同时会通过消息弹窗(实时通讯)的方式提醒到该部门的所有上班经理(即登录到该系统),该消息弹窗里面包含请假人信息以及假条的创建时间,而未上班的经理在下次上班(登录到该系统)后只会获得自己所管辖下所有的普工请假申请提醒,同样以消息提醒的方式获得,该消息提醒包含请假的条数。经理在审批了普工的假条过后会通过通过消息弹窗(实时通讯)的方式返回审批结果给对应的普工,普工可以查看自己的假条状态以及对其进行销假(删除该假条),经理也是基本一致,不过经理的审批人则变成了老总**
- **设计实现:**
  - **普工/经理的假条提交: 通过`elementUI`组件的`form`表单组件提交请假数据(首先对`Vuex`中的数据进行校验确定当前的用户信息与表单的用户填写信息是否一致)到数据库,同时通过`WebSocket`将当前用户提交的请假数据以及当前的用户职位类型发送给对应的上级(通过服务器),用于提醒当前在线的部门经理/老总**
  - **部门经理/老总审批假条:**
    - **`在线的经理/老总`会通过订阅对应的`webSocket`标志来接收下级的请假信息并通过`elementUI`组件库的非自动关闭弹窗组件来展示,随后`部门经理`/`老总`就可以跳转到对应的请假管理页面获取当`前部门下所有普工`/`所有部门经理`的假条,然后审批对应的假条,这一步骤同样是沟通数据库来修改对应`id`的假条数据(`同意或拒绝`),在审批过后,再次通过`WebSocket`将假条的审批状态通过假条上提供的请假人信息(请假人id,请假人职位类型)返回给对应的`普工`/`部门经理`,完成整个审批流程**
    - **`非在线的经理/老总`在下次上班打开系统(整个`Vue`项目实例创建)时会获取`自己所在部门下的普工`/`部门经理`的所有假条,通过这个假条数据的条数来获得提醒(`提醒当前您有多少条假条需要审批`)**
- **存在问题以及解决方式:**
  - **现在存在一个问题:`Vue`实例创建的时候是整个`Vue`项目被启动的时候,也就是用户在浏览器中输入网址登陆系统,但是对于未登录获得`token`之前所有的页面都会被重定向到登陆页面,此时的`Vuex`中是没有用户数据的,也就是在整个`Vue`项目实例创建的时候(打开系统)获取`自己所在部门下的普工`/`部门经理`的所有假条不现实,因为你现在没有`token`,也就无法发送任何的网络请求。**
  - **解决办法:与之前一样,同样是在整个`Vue`项目实例创建的时候(打开系统)获取`自己所在部门下的普工`/`部门经理`的所有假条,但是不是直接获取,而是通过使用`Vue`中的监视属性(`watch`),监视属性监视`Vuex`中的用户信息数据(登录之后调用`mutation`将登录的用户数据上传到`Vuex`中),一但这个数据(`id工号`,`type职位类型`,`department所在部门`)存在则在发送网络请求来获取`自己所在部门下的普工`/`部门经理`的所有假条数据,这样就解决了!**

### 2. **公告的未读提醒**

- **功能需求:**
  - **老总在新增公告的同时会通过消息弹窗(实时通讯)的方式提醒到该公告下的通知部门所有的`上班(在线)的员工`,该消息包含新增或修改公告的标题信息以及新增或修改的时间。对未上班的员工,等其在上班过后同样做一个消息提醒,不过这个消息提醒可以简略的提醒为:有最新的公告提醒即可**
- **实现设计:**
  - **老总在新增公告后会通过`WebScoket`的方式向指定部门的在线员工发送新增公告消息(消息包含修改或新增的公告标题[方便员工知道是哪一则公告]以及修改或新增公告的时间),同时调用接口修改数据库中所有员工的`isReadNotice`(0为未读,1为已读)属性**
  - **`非在线员工`则在下次上班登录系统(整个`Vue`项目实例创建)的时候,通过获取当前数据库中用户的`isReadNotice`属性来得到提醒:当前有最新的公告请及时观看**
- **存在问题以及解决方式:**
  - **存在问题:与请假功能的问题一致(对于未登录获得`token`之前所有的页面都会被重定向到登陆页面,此时的`Vuex`中是没有用户数据的,也就无法发送网路请求来获取当前的公告已读属性)**
  - **解决方法:与请假问题的解决方法一致(通过`watch`属性判断当前用户的登陆状态=>`Vuex中的用户数据`)**

### 3. **部门管理(管理员)**

- **功能需求:**
  - **实现对该公司下所有的部门进行增删改查,同时会影响对应的部门员工以及经理**
- **实现设计:**
  - **基本与公告接口的增删改查基本一致,不过不同的是员工表(`crew`)与部门表(`department`)以`外键约束`的方式联合在一起,两张表的关联属性为:员工表(`crew`)的`department`字段和部门表(`department`)的`d_name`字段,也就是说在`老总`级别人物在更改或删除现有的部门时,其部门中对应的员工的所在部门属性也就是`department`字段也会随之改变,这就是`外键约束`的`SET NULL`模式**

### 4. 文件管理

- **公司的电子仓库用于保存公司的文件,但是文件或获取是分阶级的,指定部门的普工和经理只能获取自己部门的文件,但是老总级别的员工却能获取公司所有的文件,文件的上传和下载是指定格式的(压缩包7z),因为我的电脑压缩软件是用的`7-zip`**
- **文件的上传同样是使用`multer`插件,但是与上传头像不同的是,上传到数据库使用的是磁盘存储模式(`上传到服务器使用的是内存存储模式`)**
